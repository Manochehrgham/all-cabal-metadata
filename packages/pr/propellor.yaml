homepage: https://propellor.branchable.com/
changelog-type: text
hash: f29b974139ad0012e95ddeb798829774e80d798af14c1dc9369216fa446e3faf
test-bench-deps: {}
maintainer: Joey Hess <id@joeyh.name>
synopsis: property-based host configuration management in haskell
changelog: ! "propellor (2.15.3) unstable; urgency=medium\n\n  * Added Git.bareRepoDefaultBranch
  property\n    Thanks, Sean Whitton.\n  * Add missing Control.Applicative imports
  needed by older versions of ghc.\n\n -- Joey Hess <id@joeyh.name>  Tue, 12 Jan 2016
  12:37:22 -0400\n\npropellor (2.15.2) unstable; urgency=medium\n\n  * Added GNUPGBIN
  environment variable or git.program git config\n    to control the command run for
  gpg. Allows eg, GNUPGBIN=gpg2\n    Thanks, Félix Sipma.\n  * Bootstrap apt-get installs
  run with deconf noninteractive frontend.\n  * spin --via: Avoid committing on relay
  host.\n  * Postfix: Add service property to enable/disable services in master.cf.\n
  \ * Added Munin module, contributed by Jelmer Vernooij.\n\n -- Joey Hess <id@joeyh.name>
  \ Sun, 03 Jan 2016 16:56:26 -0400\n\npropellor (2.15.1) unstable; urgency=medium\n\n
  \ * Added git configs propellor.spin-branch and propellor.forbid-dirty-spin.\n    Thanks,
  Sean Whitton.\n  * Added User.systemAccountFor and User.systemAccountFor' properties.\n
  \   Thanks, Félix Sipma.\n  * Gpg.keyImported converted to not use a flag file and
  instead check\n    if gpg has the provided key already.\n    Thanks, Félix Sipma.\n
  \ * Clean build with ghc 7.10.\n  * Merged Utility changes from git-annex.\n\n --
  Joey Hess <id@joeyh.name>  Sat, 19 Dec 2015 16:43:09 -0400\n\npropellor (2.15.0)
  unstable; urgency=medium\n\n  * Added UncheckedProperty type, along with unchecked
  to indicate a\n    Property needs its result checked, and checkResult and changesFile\n
  \   to check for changes.\n  * Properties that run an arbitrary command, such as
  cmdProperty\n    and scriptProperty are converted to use UncheckedProperty, since\n
  \   they cannot tell on their own if the command truely made a change or not.\n
  \   (API Change)\n    Transition guide:\n    - When GHC complains about an UncheckedProperty,
  add:\n    \t`assume` MadeChange\n      (Since these properties used to always return
  MadeChange, that\n      change is always safe to make.)\n    - Or, if you know that
  the command should modifiy a file, use:\n    \t`changesFile` filename\n  * The `trivial`
  combinator has been removed. (API change)\n    Instead, use:\n    \t`assume` NoChange\n
  \   Or, better, use changesFile or checkResult to accurately report\n    when a
  property makes a change.\n  * A few properties have had their Result improved, for
  example\n    Apt.buldDep and Apt.autoRemove now check if a change was made or not.\n
  \ * User.hasDesktopGroups changed to avoid trying to add the user to\n    groups
  that don't exist.\n  * Added Postfix.saslPasswdSet.\n  * Added Propellor.Property.Locale.\n
  \   Thanks, Sean Whitton.\n  * Added Propellor.Property.Fail2Ban.\n\n -- Joey Hess
  <id@joeyh.name>  Sun, 06 Dec 2015 15:33:51 -0400\n\npropellor (2.14.0) unstable;
  urgency=medium\n\n  * Add Propellor.Property.PropellorRepo.hasOriginUrl, an explicit
  way to\n    set the git repository url normally implicitly set when using --spin.\n
  \ * Added Chroot.noServices property.\n  * DiskImage creation automatically uses
  Chroot.noServices.\n  * Removed the (unused) dependency on quickcheck.\n  * DebianMirror:
  Added a DebianMirror type for configuration (API change)\n    Thanks, Félix Sipma.\n
  \ * DebianMirror: Add RsyncExtra to configuration.\n    Thanks, Félix Sipma.\n  *
  Added Git.repoConfigured and Git.repoAcceptsNonFFs properties.\n    Thanks, Sean
  Whitton\n  * Added User.hasDesktopGroups property.\n\n -- Joey Hess <id@joeyh.name>
  \ Tue, 24 Nov 2015 16:03:55 -0400\n\npropellor (2.13.0) unstable; urgency=medium\n\n
  \ * RevertableProperty used to be assumed to contain info, but this is\n    now
  made explicit, with RevertableProperty HasInfo or\n    RevertableProperty NoInfo.
  (API change)\n    Transition guide:\n      - If you define a RevertableProperty,
  expect some type check\n        failures like: \"Expecting one more argument to
  ‘RevertableProperty’\".\n      - Change it to \"RevertableProperty NoInfo\"\n      -
  The compiler will then tell you if it needs \"HasInfo\" instead.\n      - If you
  have code that uses the RevertableProperty constructor\n        that fails to type
  check, use the more powerful <!> operator\n        instead to create the RevertableProperty.\n
  \ * Various property combinators that combined a RevertableProperty\n    with a
  non-revertable property used to yield a RevertableProperty.\n    This was a bug,
  because the combined property could not be fully\n    reverted in many cases, and
  the result is now a non-revertable property.\n  * combineWith now takes an additional
  parameter to control how revert\n    actions are combined (API change).\n  * Added
  Propellor.Property.Concurrent for concurrent properties.\n  * Made the execProcess
  exported by propellor, and everything built on it,\n    avoid scrambled output when
  run concurrently.\n  * Propellor now depends on STM and text.\n  * The cabal file
  now builds propellor with -O. While -O0 makes ghc\n    take less memory while building
  propellor, it can lead to bad memory\n    usage at runtime due to eg, disabled stream
  fusion.\n  * Add File.isCopyOf. Thanks, Per Olofsson.\n\n -- Joey Hess <id@joeyh.name>
  \ Sun, 08 Nov 2015 14:51:15 -0400\n\npropellor (2.12.0) unstable; urgency=medium\n\n
  \ * The DiskImage module can now make bootable images using grub.\n  * Add a ChrootTarball
  chroot type, for using pre-built tarballs\n    as chroots. Thanks, Ben Boeckel.\n
  \ * HostName: Improve domain extraction code.\n  * Added Mount.fstabbed property
  to generate /etc/fstab to replicate\n    current mounts.\n  * HostName: Improve
  domain extraction code.\n  * Add File.basedOn. Thanks, Per Olofsson.\n  * Changed
  how the operating system is provided to Chroot (API change).\n    Where before debootstrapped
  and bootstrapped took a System parameter,\n    the os property should now be added
  to the Chroot.\n  * Follow-on change to Systemd.container, which now takes a System
  parameter.\n  * Generalized Property.check so it can be used with Propellor actions
  as\n    well as IO actions.\n  * Hostname.sane and Hostname.setTo can now safely
  be used as a property\n    of a chroot, and won't affect the hostname of the host
  system.\n\n -- Joey Hess <id@joeyh.name>  Fri, 23 Oct 2015 17:38:32 -0400\n\npropellor
  (2.11.0) unstable; urgency=medium\n\n  * Rewrote Propellor.Property.ControlHeir
  one more time, renaming it to\n    Propellor.Property.Conductor.\n  * Added Ssh
  properties to remove authorized_keys and known_hosts lines.\n\n -- Joey Hess <id@joeyh.name>
  \ Wed, 21 Oct 2015 19:49:00 -0400\n\npropellor (2.10.0) unstable; urgency=medium\n\n
  \ * The Propellor.Property.Spin added in the last release is replaced\n    with
  a very different Propellor.Property.ControlHeir.\n\n -- Joey Hess <id@joeyh.name>
  \ Tue, 20 Oct 2015 21:29:12 -0400\n\npropellor (2.9.0) unstable; urgency=medium\n\n
  \ * Added basic Uwsgi module, maintained by Félix Sipma.\n  * Add Apt.hasForeignArch.
  Thanks, Per Olofsson.\n  * Improved documentation, particularly of the Propellor
  module.\n  * The Propellor module no longer exports many of the things it used to,\n
  \   being now focused on only what's needed to write config.hs.\n    Use Propellor.Base
  to get all the things exported by Propellor before.\n    (API change)\n  * Some
  renaming of instance methods, and moving of functions to more\n    appropriate modules.
  (API change)\n  * Added File.isSymlinkedTo. Thanks, Per Olofsson.\n  * fileProperty,
  and properties derived from it now write the new\n    file content via origfile.propellor-new~,
  instead of to a randomly named\n    temp file. This allows them to clean up any
  temp file that may have\n    been left by an interrupted run of propellor.\n  *
  Added Propellor.Property.Spin, which can be used to make a host be a\n    controller
  of other hosts, which will automatically spin them each time\n    propellor is run.\n
  \ * Ssh.keyImported is replaced with Ssh.userKeys. (API change)\n    The new property
  only gets the private key from the privdata; the\n    public key is provided as
  a parameter, and so is available as\n    Info that other properties can use.\n  *
  Ssh.keyImported' is renamed to Ssh.userKeyAt, and also changed\n    to only import
  the private key from the privdata. (API change)\n  * While Ssh.keyImported and Ssh.keyImported'
  avoided updating existing\n    keys, the new Ssh.userKeys and Ssh.userKeyAt properties
  will\n    always update out of date key files.\n  * Ssh.pubKey renamed to Ssh.hostPubKey.
  (API change)\n  * Added --unset-unused \n  * Fix typo: propigate → propagate. Thanks,
  Felix Gruber.\n    (A minor API change)\n  * Chroot: Converted to use a ChrootBootstrapper
  type class, so\n    other ways to bootstrap chroots can easily be added in separate\n
  \   modules. (API change)\n\n -- Joey Hess <id@joeyh.name>  Tue, 20 Oct 2015 15:43:12
  -0400\n\npropellor (2.8.1) unstable; urgency=medium\n\n  * Guard against power loss
  etc when building propellor, by updating\n    the executable atomically.\n  * Added
  Logcheck module, contributed by Jelmer Vernooij.\n  * Added Kerberos module, contributed
  by Jelmer Vernooij.\n  * Privdata that uses HostContext inside a container will
  now have the\n    name of the container as its context, rather than the name of\n
  \   the host(s) where the container is used. This allows eg, having different\n
  \   passwords for a user in different containers. Note that previously,\n    propellor
  would prompt using the container name as the context, but\n    not actually use
  privdata using that context; so this is a bug fix.\n  * Fix --add-key to not fail
  committing when no privdata file exists yet.\n\n -- Joey Hess <id@joeyh.name>  Sun,
  04 Oct 2015 13:54:59 -0400\n\npropellor (2.8.0) unstable; urgency=medium\n\n  *
  Added Propellor.Property.Rsync.\n  * Convert Info to use Data.Dynamic, so properties
  can export and consume\n    info of any type that is Typeable and a Monoid, including
  data types\n    private to a module. (API change)\n    Thanks to Joachim Breitner
  for the idea.\n  * Improve propellor wrapper to better handle installation cloning\n
  \   the public propellor repo, by setting that repo to be upstream,\n    so propellor
  doesnt try to push to a read-only repo.\n  * Added DebianMirror module, contributed
  by Félix Sipma.\n  * Some hlint cleanups.\n    Thanks, Mario Lang\n  * Added Propellor.Property.Unbound
  for the caching DNS server.\n    Thanks, Félix Sipma.\n  * Added PTR to Dns.Record.
  While this is ignored by\n    Propellor.Property.Dns for now, since reverse DNS
  setup is not\n    implemented there yet, it can be used in other places, eg Unbound.\n
  \   Thanks, Félix Sipma.\n  * PrivData converted to newtype (API change).\n  * Stopped
  stripping trailing newlines when setting PrivData;\n    this was previously done
  to avoid mistakes when pasting eg passwords\n    with an unwanted newline. Instead,
  PrivData consumers should use either\n    privDataLines or privDataVal, to extract
  respectively lines or a\n    value (without internal newlines) from PrivData.\n
  \ * Allow storing arbitrary ByteStrings in PrivData, extracted using\n    privDataByteString.\n
  \ * Added Aiccu module, contributed by Jelmer Vernooĳ.\n  * Added --rm-key.\n\n
  -- Joey Hess <id@joeyh.name>  Tue, 22 Sep 2015 19:35:07 -0400\n\npropellor (2.7.3)
  unstable; urgency=medium\n\n  * Fix bug that caused provisioning new chroots to
  fail.\n  * Update for Debian systemd-container package split.\n  * Added Propellor.Property.Parted,
  for disk partitioning.\n  * Added Propellor.Property.Partition, for partition formatting
  etc.\n  * Added Propellor.Property.DiskImage, for bootable disk image creation.\n
  \   (Experimental and not yet complete.)\n  * Dropped support for ghc 7.4.\n\n --
  Joey Hess <id@joeyh.name>  Thu, 03 Sep 2015 08:52:51 -0700\n\npropellor (2.7.2)
  unstable; urgency=medium\n\n  * Added Propellor.Property.ConfFile, with support
  for Windows-style .ini\n    files, and generic support for files containing some
  sort of sections.\n    Thanks, Sean Whitton for completing the implementation.\n
  \ * Added Propellor.Property.LightDM\n    Thanks, Sean Whitton.\n  * Multiple Tor.hiddenService
  properties can now be defined for a host;\n    previously only one such property
  worked per host.\n    Thanks, Félix Sipma.\n\n -- Joey Hess <id@joeyh.name>  Tue,
  25 Aug 2015 12:00:25 -0700\n\npropellor (2.7.1) unstable; urgency=medium\n\n  *
  Make sure that make is installed when bootstrapping propellor.\n  * Fix bug in Firewall's
  Port datatype to iptable parameter translation code.\n    Thanks, Antoine Eiche.\n\n
  -- Joey Hess <id@joeyh.name>  Fri, 14 Aug 2015 15:01:37 -0400\n\npropellor (2.7.0)
  unstable; urgency=medium\n\n  * Ssh.permitRootLogin type changed to allow configuring
  WithoutPassword\n    and ForcedCommandsOnly (API change)\n  * setSshdConfig type
  changed, and setSshdConfigBool added with old type.\n  * Fix a bug in shim generation
  code for docker and chroots, that\n    sometimes prevented deployment of docker
  containers.\n  * Added onChangeFlagOnFail which is often a safer alternative to\n
  \   onChange.\n    Thanks, Antoine Eiche.\n  * Work around broken git pull option
  parser in git 2.5.0,\n    which broke use of --upload-pack to send a git push when
  running\n    propellor --spin.\n\n -- Joey Hess <id@joeyh.name>  Thu, 30 Jul 2015
  12:05:46 -0400\n\npropellor (2.6.0) unstable; urgency=medium\n\n  * Replace String
  type synonym Docker.Image by a data type\n    which allows to specify an image name
  and an optional tag. (API change)\n    Thanks, Antoine Eiche.\n  * Added --unset
  to delete a privdata field.\n  * Version dependency on exceptions.\n  * Systemd:
  Add masked property.\n    Thanks, Sean Whitton\n  * Fix make install target to work
  even when git is not configured.\n\n -- Joey Hess <id@joeyh.name>  Fri, 10 Jul 2015
  22:36:29 -0400\n\npropellor (2.5.0) unstable; urgency=medium\n\n  * cmdProperty'
  renamed to cmdPropertyEnv to make way for a new,\n    more generic cmdProperty'
  (API change)\n  * Add docker image related properties.\n    Thanks, Antoine Eiche.\n
  \ * Export CommandParam, boolSystem, safeSystem, shellEscape, and\n    createProcess
  from Propellor.Property.Cmd, so they are available\n    for use in constricting
  your own Properties when using propellor\n    as a library.\n  * Improve enter-machine
  scripts for systemd-nspawn containers to unset most\n    environment variables.\n
  \ * Fix Postfix.satellite bug; the default relayhost was set to the\n    domain,
  not to smtp.domain as documented.\n  * Mount /proc inside a chroot before provisioning
  it, to work around #787227\n  * --spin now works when given a short hostname that
  only resolves to an\n    ipv6 address.\n  * Added publish property for systemd-spawn
  containers, for port publishing.\n    (Needs systemd version 220.)\n  * Added bind
  and bindRo properties for systemd-spawn containers.\n  * Firewall: Port was changed
  to a newtype, and the Port and PortRange\n    constructors of Rules were changed
  to DPort and DportRange, respectively.\n    (API change)\n  * Docker: volume and
  publish accept Bound FilePath and Bound Port,\n    respectively. They also continue
  to accept Strings, for backwards\n    compatibility.\n  * Docker: Added environment
  property.\n    Thanks Antoine Eiche.\n\n -- Joey Hess <id@joeyh.name>  Tue, 09 Jun
  2015 17:08:43 -0400\n\npropellor (2.4.0) unstable; urgency=medium\n\n  * Propellor
  no longer supports Debian wheezy (oldstable).\n  * Git.bareRepo: Fix bug in calls
  to userScriptProperty.\n    Thanks, Jelmer Vernooij.\n  * Removed Obnam.latestVersion
  which was only needed for Debian wheezy\n    backport.\n  * Merged Utility changes
  from git-annex.\n  * Switched from MonadCatchIO-transformers to the newer transformers
  and\n    exceptions libraries.\n  * Ensure build deps are installed before building
  propellor in --spin\n    and cron job, even if propellor was already built before,
  to deal with\n    upgrades that add new dependencies.\n\n -- Joey Hess <id@joeyh.name>
  \ Wed, 06 May 2015 14:28:59 -0400\n\npropellor (2.3.0) unstable; urgency=medium\n\n
  \ * Make propellor resistent to changes to shared libraries, such as libffi,\n    which
  might render the propellor binary unable to run. This is dealt with\n    by checking
  the binary both when running propellor on a remote host,\n    and by Cron.runPropellor.
  If the binary doesn't work, it will be rebuilt.\n  * Note that since a new switch
  had to be added to allow testing the binary,\n    upgrading to this version will
  cause a rebuild from scratch of propellor.\n  * Added hasLoginShell and shellEnabled.\n
  \ * debCdn changed to new httpredir.debian.org official replacement for\n    http.debian.net.\n
  \ * API change: Added User and Group newtypes, and Properties that\n    used to
  use the type UserName = String were changed to use them.\n\n -- Joey Hess <id@joeyh.name>
  \ Wed, 22 Apr 2015 13:46:24 -0400\n\npropellor (2.2.1) unstable; urgency=medium\n\n
  \ * userScriptProperty now passes --shell /bin/sh, so it can be used\n    even for
  users with nonstandard shells.\n  * Fix bug in docker propellor shim setup introduced
  in last release,\n    which broke provisioning of new docker containers.\n\n --
  Joey Hess <id@joeyh.name>  Thu, 12 Mar 2015 20:08:34 -0400\n\npropellor (2.2.0)
  unstable; urgency=medium\n\n  * When running shimmed (eg in a docker container),\n
  \   improve process name visible in ps.\n  * Add shebang to cron.daily etc files.
  \n  * Some changes to tor configuration, minor API change.\n  * Propellor now builds
  itself, and gets its build dependencies installed\n    when deploying to a new host,
  without needing the Makefile.\n\n -- Joey Hess <id@joeyh.name>  Mon, 09 Mar 2015
  12:02:31 -0400\n\npropellor (2.1.0) unstable; urgency=medium\n\n  * Additional tor
  properties, including support for making relays, \n    and naming bridges, relays,
  etc.\n  * New Cron.Times data type, which allows Cron.job to install\n    daily/monthly/weekly
  jobs that anacron can run. (API change)\n  * Fix Git.daemonRunning to restart inetd
  after enabling the git server.\n  * Ssh.authorizedKey: Make the authorized_keys
  file and .ssh directory\n    be owned by the user, not root.\n  * Ssh.knownHost:
  Make the .ssh directory be owned by the user, not root.\n\n -- Joey Hess <id@joeyh.name>
  \ Thu, 12 Feb 2015 12:36:26 -0400\n\npropellor (2.0.0) unstable; urgency=medium\n\n
  \ * Property has been converted to a GADT, and will be Property NoInfo\n    or Property
  HasInfo.\n    This was done to make sure that ensureProperty is only used on\n    properties
  that do not have Info.\n    Transition guide:\n    - Change all \"Property\" to
  \"Property NoInfo\" or \"Property WithInfo\"\n      (The compiler can tell you if
  you got it wrong!)\n    - To construct a RevertableProperty, it is useful to use
  the new\n      (<!>) operator\n    - Constructing a list of properties can be problimatic,
  since\n      Property NoInto and Property WithInfo are different types and cannot\n
  \     appear in the same list. To deal with this, \"props\" has been added,\n      and
  can built up a list of properties of different types,\n      using the same (&)
  and (!) operators that are used to build\n      up a host's properties.\n  * Add
  descriptions of how to set missing fields to --list-fields output.\n  * Properties
  now form a tree, instead of the flat list used before.\n    This includes the properties
  used inside a container.\n  * Fix info propagation from fallback combinator's second
  Property.\n  * Added systemd configuration properties.\n  * Added journald configuration
  properties.\n  * Added more network interface configuration properties.\n  * Implemented
  OS.preserveNetwork.\n\n -- Joey Hess <id@joeyh.name>  Sun, 25 Jan 2015 15:23:08
  -0400\n\npropellor (1.3.2) unstable; urgency=medium\n\n  * SSHFP records are also
  generated for CNAMES of hosts.\n  * Merge Utiity modules from git-annex.\n  * Ignore
  bogus DNS when spinning the local host.\n\n -- Joey Hess <id@joeyh.name>  Thu, 15
  Jan 2015 14:02:07 -0400\n\npropellor (1.3.1) unstable; urgency=medium\n\n  * Fix
  bug that prevented deploying ssh host keys when the file for the\n    key didn't
  already exist.\n  * DNS records for hosts with known ssh public keys now automatically\n
  \   include SSHFP records.\n\n -- Joey Hess <id@joeyh.name>  Sun, 04 Jan 2015 19:51:34
  -0400\n\npropellor (1.3.0) unstable; urgency=medium\n\n  * --spin checks if the
  DNS matches any configured IP address property\n    of the host, and if not, sshes
  to the host by IP address.\n  * Detect #774376 and refuse to use docker if the system
  is so broken\n    that docker exec doesn't enter a chroot.\n  * Update intermediary
  propellor in --spin --via\n  * Added support for DNSSEC.\n  * Ssh.hostKey and Ssh.hostKeys
  no longer install public keys from\n    the privdata. Instead, the public keys are
  included in the\n    configuration. (API change)\n  * Ssh.hostKeys now removes any
  host keys of types that the host is not\n    configured to have.\n  * sshPubKey
  is renamed to Ssh.pubKey, and has an added SshKeyType\n    parameter. (API change)\n
  \ * CloudAtCost.deCruft no longer forces randomHostKeys.\n  * Fix build with process
  1.2.1.0.\n\n -- Joey Hess <id@joeyh.name>  Sun, 04 Jan 2015 17:17:44 -0400\n\npropellor
  (1.2.2) unstable; urgency=medium\n\n  * Revert ensureProperty warning message, too
  many false positives in places\n    where Info is correctly propagated. Better approach
  needed.\n\n -- Joey Hess <id@joeyh.name>  Sun, 21 Dec 2014 21:41:11 -0400\n\npropellor
  (1.2.1) unstable; urgency=medium\n\n  * Added CryptPassword to PrivDataField, for
  password hashes as produced \n    by crypt(3).\n  * User.hasPassword and User.hasSomePassword
  will now use either\n    a CryptPassword or a Password from privdata, depending
  on which is set.\n\n -- Joey Hess <id@joeyh.name>  Wed, 17 Dec 2014 16:30:44 -0400\n\npropellor
  (1.2.0) unstable; urgency=medium\n\n  * Display a warning when ensureProperty is
  used on a property which has\n    Info and is so prevented from propigating it.\n
  \ * Removed boolProperty; instead the new toResult can be used. (API change)\n  *
  Include Propellor.Property.OS, which was accidentially left out of the\n    cabal
  file in the last release.\n  * Fix Apache.siteEnabled to update the config file
  and reload apache when\n    configuration has changed.\n\n -- Joey Hess <id@joeyh.name>
  \ Tue, 09 Dec 2014 00:05:09 -0400\n\npropellor (1.1.0) unstable; urgency=medium\n\n
  \ * --spin target --via relay causes propellor to bounce through an\n    intermediate
  relay host, which handles any necessary uploads\n    when provisioning the target
  host.\n  * --spin can be passed multiple hosts, and it will provision each host\n
  \   in turn.\n  * Add --merge, to combine multiple --spin commits into a single,
  more useful\n    commit.\n  * Hostname parameters not containing dots are looked
  up in the DNS to\n    find the full hostname.\n  * propellor --spin can now deploy
  propellor to hosts that do not have \n    git, ghc, or apt-get. This is accomplished
  by uploading a fairly\n    portable precompiled tarball of propellor.\n  * Propellor.Property.OS
  contains properties that can be used to do a clean\n    reinstall of the OS of an
  existing host. This can be used, for example,\n    to do an in-place conversion
  from Fedora to Debian.\n    This is experimental; use with caution!\n  * Added group-related
  properties. Thanks, Félix Sipma.\n  * Added Git.barerepo. Thanks, Félix Sipma.\n
  \ * Added Grub.installed and Grub.boots properties.\n  * New HostContext can be
  specified when a PrivData value varies per host.\n  * hasSomePassword and hasPassword
  now default to using HostContext.\n    To specify a different context, use hasSomePassword'
  and\n    hasPassword' (API change)\n  * hasSomePassword and hasPassword now make
  sure shadow passwords are enabled.\n  * cron.runPropellor now runs propellor, rather
  than using its Makefile.\n    This is more robust.\n  * propellor.debug can be set
  in the git config to enable more persistent\n    debugging output.\n  * Run apt-cache
  policy with LANG=C so it works on other locales.\n  * endAction can be used to register
  an action to run once propellor\n    has successfully run on a host.\n\n -- Joey
  Hess <id@joeyh.name>  Sun, 07 Dec 2014 15:23:59 -0400\n\npropellor (1.0.0) unstable;
  urgency=medium\n\n  * propellor --spin can now be used to update remote hosts, without\n
  \   any central git repository needed. The central git repository is\n    still
  useful for running propellor from cron, but this simplifies\n    getting started
  with propellor, and allows for more ad-hoc usage.\n  * The git repo url, if any,
  is updated whenever propellor --spin is used.\n  * Added prosody module, contributed
  by Félix Sipma.\n  * Can be used to configure tor hidden services. Thanks, Félix
  Sipma.\n  * When multiple gpg keys are added, ensure that the privdata file\n    can
  be decrypted by all of them.\n  * Convert GpgKeyId to newtype. (API change)\n  *
  DigitalOcean.distroKernel property now reboots into the distribution\n    kernel
  when necessary.\n  * Avoid outputting color setting sequences when not run on a
  terminal.\n  * Docker code simplified by using `docker exec`; needs docker 1.3.1.\n
  \ * Docker containers are now a separate data type, cannot be included\n    in the
  main host list, and are instead passed to\n    Docker.docked. (API change)\n  *
  Added support for using debootstrap from propellor.\n  * Propellor can now be used
  to provision chroots.\n  * systemd-nspawn containers can now be managed by propellor,
  very similar\n    to its handling of docker containers.\n  * Debian package will
  be maintained by Gergely Nagy.\n\n -- Joey Hess <id@joeyh.name>  Fri, 21 Nov 2014
  20:58:02 -0400\n\npropellor (0.9.2) unstable; urgency=medium\n\n  * Added nginx
  module, contributed by Félix Sipma.\n  * Added firewall module, contributed by Arnaud
  Bailly.\n  * Apache: Fix daemon reload when enabling a new module or site.\n  *
  Docker: Stop using docker.io; that was a compat symlink in\n    the Debian package
  which has been removed in docker.io 1.3.1~dfsg1-2.\n    Closes: #769452\n  * Orphaned
  the Debian package, as I am retiring from Debian.\n\n -- Joey Hess <joeyh@debian.org>
  \ Sat, 08 Nov 2014 15:57:36 -0400\n\npropellor (0.9.1) unstable; urgency=medium\n\n
  \ * Docker: Add ability to control when containers restart.\n  * Docker: Default
  to always restarting containers, so they come back \n    up after reboots and docker
  daemon upgrades. (API change)\n  * Fix loop when a docker host that does not exist
  was docked.\n\n -- Joey Hess <joeyh@debian.org>  Fri, 24 Oct 2014 09:57:31 -0400\n\npropellor
  (0.9.0) unstable; urgency=medium\n\n  * Avoid encoding the current stable suite
  in propellor's code,\n    since that poses a difficult transition around the release,\n
  \   and can easily be wrong if an older version of propellor is used.\n    Instead,
  the os property for a stable system includes the suite name\n    to use, eg Stable
  \"wheezy\".\n  * stdSourcesList uses the stable suite name, to avoid unwanted\n
  \   immediate upgrades to the next stable release. (API change)\n  * debCdn switched
  from cdn.debian.net to http.debian.net, which seems to be\n    better managed now.\n
  \ * Docker: Avoid committing container every time it's started up.\n\n -- Joey Hess
  <joeyh@debian.org>  Fri, 10 Oct 2014 11:37:45 -0400\n\npropellor (0.8.3) unstable;
  urgency=medium\n\n  * The Debian package now includes a single-revision git repository
  in\n    /usr/src/propellor/, and ~/.propellor/ is set up to use this repository
  as\n    its origin remote. This avoids relying on the security of the github\n    repository
  when using the Debian package.\n  * The /usr/bin/propellor wrapper will warn when
  ~/.propellor/ is out of date\n    and a newer version is available, after which
  git merge upstream/master\n    can be run to merge it.\n  * Included the config.hs
  symlink to config-simple.hs in the cabal and Debian\n    packages.\n\n -- Joey Hess
  <joeyh@debian.org>  Fri, 22 Aug 2014 13:02:01 -0400\n\npropellor (0.8.2) unstable;
  urgency=medium\n\n  * Fix bug in File.containsLines that caused lines that were
  already in the\n    file to sometimes be appended to the end.\n  * Hostname.sane
  also configures /etc/mailname.\n  * Fixed Postfix.satellite to really configure
  relayhost = smtp.domain.\n  * Avoid reconfiguring postfix unncessarily when it already
  has a relayhost.\n  * Deal with apache 2.4's change in the name of site-available
  config files.\n  * Hostname aliases can now be used in several places, including
  --spin\n    and Ssh.knownHost.\n\n -- Joey Hess <joeyh@debian.org>  Mon, 04 Aug
  2014 01:12:19 -0400\n\npropellor (0.8.1) unstable; urgency=medium\n\n  * Run apt-get
  update in initial bootstrap.\n  * --list-fields now includes a table of fields that
  are not currently set,\n    but would be used if they got set.\n  * Remove .gitignore
  from cabal file list, to avoid build failure on Debian.\n    Closes: #754334\n\n
  -- Joey Hess <joeyh@debian.org>  Wed, 09 Jul 2014 22:11:31 -0400\n\npropellor (0.8.0)
  unstable; urgency=medium\n\n  * Completely reworked privdata storage. There is now
  a single file,\n    and each host is sent only the privdata that its Properties
  actually use.\n\n    To transition existing privdata, run propellor against a host
  and\n    watch out for the red failure messages, and run the suggested commands\n
  \   to store the privdata using the new storage scheme. You may find\n    it useful
  to run the old version of propellor to extract data from the old\n    privdata files
  during this migration.\n\n    Several properties that use privdata now require a
  context to be\n    specified. If in doubt, you can use anyContext, or\n    Context
  \"hostname.example.com\"\n\n  * Add --edit to edit a privdata value in $EDITOR.\n
  \ * Add --list-fields to list all currently set privdata fields, along with\n    the
  hosts that use them.\n  * Fix randomHostKeys property to run openssh-server's postinst
  in a\n    non-failing way.\n  * Hostname.sane now cleans up the 127.0.0.1 localhost
  line in /etc/hosts,\n    to avoid eg, apache complaining \"Could not reliably determine
  the\n    server's fully qualified domain name\".\n\n -- Joey Hess <joeyh@debian.org>
  \ Sun, 06 Jul 2014 18:28:08 -0400\n\npropellor (0.7.0) unstable; urgency=medium\n\n
  \ * combineProperties no longer stops when a property fails; now it continues\n
  \   trying to satisfy all properties on the list before propigating the\n    failure.\n
  \ * Attr is renamed to Info. (API change)\n  * Renamed wrapper to propellor to make
  cabal installation of propellor work.\n  * When git gpg signature of a fetched git
  branch cannot be verified,\n    propellor will now continue running, but without
  merging in that branch.\n\n -- Joey Hess <joeyh@debian.org>  Fri, 13 Jun 2014 10:06:40
  -0400\n\npropellor (0.6.0) unstable; urgency=medium\n\n  * Docker containers now
  propagate DNS attributes out to the host they're\n    docked in. So if a docker
  container sets a DNS alias, every container\n    it's docked in will automatically
  be added to a DNS round-robin,\n    when propellor is used to manage DNS for the
  domain.\n  * Apt.stdSourcesList no longer needs a suite to be specified. (API change)\n
  \ * Added --dump to dump out a field of a host's privdata. Useful for editing\n
  \   it.\n  * Propellor's output now includes the hostname being provisioned, or\n
  \   when provisioning a docker container, the container name.\n\n -- Joey Hess <joeyh@debian.org>
  \ Thu, 05 Jun 2014 17:32:14 -0400\n\npropellor (0.5.3) unstable; urgency=medium\n\n
  \ * Fix unattended-upgrades config for !stable.\n  * Ensure that kernel hostname
  is same as /etc/hostname when configuring\n    hostname.\n  * Added modules for
  some hosting providers (DigitalOcean, CloudAtCost).\n\n -- Joey Hess <joeyh@debian.org>
  \ Thu, 29 May 2014 14:29:53 -0400\n\npropellor (0.5.2) unstable; urgency=medium\n\n
  \ * A bug that caused propellor to hang when updating a running docker\n    container
  appears to have been fixed. Note that since it affects\n    the propellor process
  that serves as \"init\" of docker containers,\n    they have to be restarted for
  the fix to take effect.\n  * Licence changed from GPL to BSD.\n  * A few changes
  to allow building Propellor on OSX. One user reports\n    successfully using it
  there.\n\n -- Joey Hess <joeyh@debian.org>  Sat, 17 May 2014 16:42:55 -0400\n\npropellor
  (0.5.1) unstable; urgency=medium\n\n  * Primary DNS servers now have allow-transfer
  automatically populated\n    with the IP addresses of secondary dns servers. So,
  it's important\n    that all secondary DNS servers have an ipv4 (and/or ipv6) property\n
  \   configured.\n  * Deal with old ssh connection caching sockets.\n  * Add missing
  build deps and deps. Closes: #745459\n\n -- Joey Hess <joeyh@debian.org>  Thu, 24
  Apr 2014 18:09:58 -0400\n\npropellor (0.5.0) unstable; urgency=medium\n\n  * Removed
  root domain records from SOA. Instead, use RootDomain\n    when calling Dns.primary.
  (API change)\n  * Dns primary and secondary properties are now revertable.\n  *
  When unattendedUpgrades is enabled on an Unstable or Testing system,\n    configure
  it to allow the upgrades.\n  * New website, https://propellor.branchable.com/\n\n
  -- Joey Hess <joeyh@debian.org>  Sat, 19 Apr 2014 17:38:02 -0400\n\npropellor (0.4.0)
  unstable; urgency=medium\n\n  * Propellor can configure primary DNS servers, including
  generating\n    zone files, which is done by looking at the properties of hosts\n
  \   in a domain.\n  * The `cname` property was renamed to `alias` as it does not
  always\n    generate CNAME in the DNS. (API change)\n  * Constructor of Property
  has changed (use `property` function instead).\n    (API change)\n  * All Property
  combinators now combine together their Attr settings.\n    So Attr settings can
  be made inside a propertyList, for example.\n  * Run all cron jobs under chronic
  from moreutils to avoid unnecessary\n    mails.\n\n -- Joey Hess <joeyh@debian.org>
  \ Sat, 19 Apr 2014 02:09:56 -0400\n\npropellor (0.3.1) unstable; urgency=medium\n\n
  \ * Merge scheduler bug fix from git-annex.\n  * Support for provisioning hosts
  with ssh and gpg keys.\n  * Obnam support.\n  * Apache support.\n  * Postfix satellite
  system support.\n  * Properties can now be satisfied differently on different operating\n
  \   systems.\n  * Standard apt configuration for stable now includes backports.\n
  \ * Cron jobs generated by propellor use flock(1) to avoid multiple\n    instances
  running at a time.\n  * Add support for SSH ed25519 keys.\n    (Thanks, Franz Pletz.)\n\n
  -- Joey Hess <joeyh@debian.org>  Thu, 17 Apr 2014 20:07:33 -0400\n\npropellor (0.3.0)
  unstable; urgency=medium\n\n  * ipv6to4: Ensure interface is brought up automatically
  on boot.\n  * Enabling unattended upgrades now ensures that cron is installed and\n
  \   running to perform them.\n  * Properties can be scheduled to only be checked
  after a given time period.\n  * Fix bootstrapping of dependencies.\n  * Fix compilation
  on Debian stable.\n  * Include security updates in sources.list for stable and testing.\n
  \ * Use ssh connection caching, especially when bootstrapping.\n  * Properties now
  run in a Propellor monad, which provides access to\n    attributes of the host.
  (API change)\n\n -- Joey Hess <joeyh@debian.org>  Fri, 11 Apr 2014 01:19:05 -0400\n\npropellor
  (0.2.3) unstable; urgency=medium\n\n  * docker: Fix laziness bug that caused running
  containers to be\n    unnecessarily stopped and committed.\n  * Add locking so only
  one propellor can run at a time on a host.\n  * docker: When running as effective
  init inside container, wait on zombies.\n  * docker: Added support for configuring
  shared volumes and linked\n    containers.\n\n -- Joey Hess <joeyh@debian.org>  Tue,
  08 Apr 2014 02:07:37 -0400\n\npropellor (0.2.2) unstable; urgency=medium\n\n  *
  Now supports provisioning docker containers with architecture/libraries\n    that
  do not match the host.\n  * Fixed a bug that caused file modes to be set to 600
  when propellor\n    modified the file (did not affect newly created files).\n\n
  -- Joey Hess <joeyh@debian.org>  Fri, 04 Apr 2014 01:07:32 -0400\n\npropellor (0.2.1)
  unstable; urgency=medium\n\n  * First release with Debian package.\n\n -- Joey Hess
  <joeyh@debian.org>  Thu, 03 Apr 2014 01:43:14 -0400\n\npropellor (0.2.0) unstable;
  urgency=low\n\n  * Added support for provisioning Docker containers.\n  * Bootstrap
  deployment now pushes the git repo to the remote host\n    over ssh, securely.\n
  \ * propellor --add-key configures a gpg key, and makes propellor refuse\n    to
  pull commits from git repositories not signed with that key.\n    This allows propellor
  to be securely used with public, non-encrypted\n    git repositories without the
  possibility of MITM.\n  * Added support for type-safe reversions. Only some properties
  can be\n    reverted; the type checker will tell you if you try something that won't\n
  \   work.\n  * New syntactic sugar for building a list of properties, including\n
  \   revertable properties.\n\n -- Joey Hess <joeyh@debian.org>  Wed, 02 Apr 2014
  13:57:42 -0400\n"
basic-deps:
  MissingH: -any
  exceptions: ! '>=0.6'
  bytestring: -any
  unix: -any
  stm: -any
  base: ! '>=4.5 && <5'
  time: -any
  text: -any
  unix-compat: -any
  filepath: -any
  process: -any
  network: -any
  async: -any
  containers: ! '>=0.5'
  ansi-terminal: -any
  hslogger: -any
  mtl: -any
  IfElse: -any
  transformers: -any
  directory: -any
all-versions:
- '0.1'
- '0.1.1'
- '0.1.2'
- '0.2.0'
- '0.2.1'
- '0.2.2'
- '0.2.3'
- '0.3.0'
- '0.3.1'
- '0.4.0'
- '0.5.0'
- '0.5.1'
- '0.5.3'
- '0.6.0'
- '0.7.0'
- '0.8.0'
- '0.8.1'
- '0.8.2'
- '0.8.3'
- '0.9.0'
- '0.9.1'
- '0.9.2'
- '1.0.0'
- '1.2.0'
- '1.2.1'
- '1.3.2'
- '2.1.0'
- '2.2.0'
- '2.2.1'
- '2.3.0'
- '2.4.0'
- '2.5.0'
- '2.6.0'
- '2.7.0'
- '2.7.1'
- '2.7.2'
- '2.7.3'
- '2.8.0'
- '2.8.1'
- '2.9.0'
- '2.10.0'
- '2.11.0'
- '2.12.0'
- '2.13.0'
- '2.14.0'
- '2.15.0'
- '2.15.1'
- '2.15.2'
- '2.15.3'
author: Joey Hess
latest: '2.15.3'
description-type: markdown
description: ! "[Propellor](https://propellor.branchable.com/) is a\nconfiguration
  management system using Haskell and Git.\nEach system has a list of properties,
  which Propellor ensures\nare satisfied.\n\nPropellor is configured via a git repository,
  which typically lives\nin `~/.propellor/` on your development machine. Propellor
  clones the\nrepository to each host it manages, in a \n[secure](http://propellor.branchable.com/security/)
  way. See \n[components](http://propellor.branchable.com/components/)\nfor details.\n\nProperties
  are defined using Haskell. Edit `~/.propellor/config.hs`\nto get started. There
  is fairly complete \n[API documentation](http://hackage.haskell.org/package/propellor/),\nwhich
  includes many built-in Properties for dealing with\n[Apt](http://hackage.haskell.org/package/propellor/docs/Propellor-Property-Apt.html)\nand\n[Apache](http://hackage.haskell.org/package/propellor/docs/Propellor-Property-Apache.html)\n,\n[Cron](http://hackage.haskell.org/package/propellor/docs/Propellor-Property-Cron.html)\nand\n[Commands](http://hackage.haskell.org/package/propellor/docs/Propellor-Property-Cmd.html)\n,\n[Dns](http://hackage.haskell.org/package/propellor/docs/Propellor-Property-Dns.html)\nand\n[Docker](http://hackage.haskell.org/package/propellor/docs/Propellor-Property-Docker.html),
  etc.\n\nThere is no special language as used in puppet, chef, ansible, etc.. just\nthe
  full power of Haskell. Hopefully that power can be put to good use in\nmaking declarative
  properties that are powerful, nicely idempotent, and\neasy to adapt to a system's
  special needs!\n\nIf using Haskell to configure Propellor seems intimidating,\nsee
  [configuration for the Haskell newbie](https://propellor.branchable.com/haskell_newbie/).\n\n##
  quick start\n\n1. Get propellor installed on your development machine (ie, laptop).\n
  \    `cabal install propellor`\n          or\n     `apt-get install propellor`\n2.
  Run `propellor` for the first time. It will set up a `~/.propellor/` git\n   repository
  for you.\n3. If you don't have a gpg private key already, generate one: `gpg --gen-key`\n4.
  Run: `propellor --add-key $KEYID`, which will make propellor trust\n   your gpg
  key, and will sign your `~/.propellor` repository using it.\n5. Edit `~/.propellor/config.hs`,
  and add a host you want to manage.\n   You can start by not adding any properties,
  or only a few.\n6. Run: `propellor --spin $HOST`\n7. Now you have a simple propellor
  deployment, but it doesn't do\n   much to the host yet, besides installing propellor.
  \ \n   So, edit `~/.propellor/config.hs` to configure the host, add some\n   properties
  to it, and re-run step 6.  \n   Repeat until happy and move on to the next host.
  :)\n8. Once you have a lot of hosts, and running `propellor --spin HOST` for\n   each
  host becomes tiresome, you can\n   [automate that](http://propellor.branchable.com/automated_spins/).\n9.
  Write some neat new properties and send patches!\n"
license-name: BSD3
